# ==============================================================================
# Inputs inside run_detection_model

traces_torch[:, None, :] * input_scale * inference_scaling

input_scale
0.15887516
inference_scaling
np.float64(0.3761194029850746)

a = traces_torch[:, None, :] * input_scale * inference_scaling
a[0,:,:]
tensor([[-0.4783,  0.7168, -1.9131,  1.0752, -1.1953,  1.0752,  0.0000, -0.4783,
          1.7920, -0.4783,  0.7168, -0.4783,  0.3584,  0.7168,  0.0000,  1.4336,
         -0.8369,  0.7168,  0.3584, -1.1953,  1.0752, -0.8369,  0.7168,  0.7168,
          0.3584,  0.3584, -1.5527,  0.7168, -0.8369,  1.4336,  0.7168, -0.8369,
          1.4336, -1.1953,  0.3584, -0.8369,  0.3584,  0.3584, -1.5527,  0.0000,
         -1.1953,  0.7168,  0.0000,  0.0000,  1.0752, -1.1953,  1.4336,  0.3584,
          0.0000,  1.0752, -1.1953,  1.0752, -0.8369,  0.0000, -1.1953, -1.1953,
          1.4336, -0.8369,  1.0752, -0.4783,  0.0000,  0.3584, -1.5527,  1.0752,
         -0.8369,  0.7168,  0.0000, -0.4783,  1.7920, -0.8369,  1.4336, -0.8369,
         -0.4783,  1.0752, -1.1953,  0.7168,  0.0000,  1.0752, -0.4783, -0.8369,
          0.3584, -1.1953,  1.7920,  0.0000, -1.1953,  1.4336,  0.0000,  1.0752,
         -0.4783,  1.7920,  0.0000, -0.4783,  1.4336, -1.1953,  0.7168, -0.8369,
          0.0000,  0.0000, -1.1953,  0.3584, -1.5527,  0.3584,  0.0000, -0.8369,
          0.3584, -1.1953,  0.0000, -0.8369, -0.4783,  0.3584, -0.4783,  0.7168,
         -1.5527, -0.4783, -1.9131, -1.1953,  0.7168, -0.8369,  0.7168, -1.5527,
          0.0000,  0.7168,  0.0000,  1.7920, -0.4783,  0.7168,  0.3584, -0.4783,
          1.4336, -0.8369,  1.4336,  0.3584,  1.0752,  0.0000, -0.4783,  2.2715,
          0.3584,  0.0000,  0.0000,  0.0000,  0.7168,  0.0000,  0.7168, -1.1953,
          0.7168,  1.0752, -0.8369,  2.2715, -0.4783,  0.3584, -0.4783,  0.0000,
          1.0752, -1.1953,  1.0752, -0.4783, -0.4783,  0.7168, -0.4783,  1.0752,
         -0.8369,  0.7168,  0.0000,  0.3584,  1.7920, -1.1953, -0.4783, -0.4783,
         -0.4783, -0.4783, -0.8369,  1.0752, -1.9131, -0.8369, -0.8369, -0.4783,
          0.7168, -0.4783,  0.3584, -1.1953, -0.4783,  0.3584, -1.1953,  1.0752,
         -0.4783,  0.7168, -1.1953, -0.8369,  0.7168, -1.1953,  1.0752,  0.3584,
          0.0000,  0.0000, -0.4783,  0.3584, -1.1953,  0.7168, -0.4783, -1.1953]],
       dtype=torch.float16)
       
outputs[0,:,:]
tensor([[-15.8359, -16.4375, -16.3750, -17.2031, -16.9375, -16.6406, -16.1406,
         -16.1406, -16.7344, -16.4219, -16.5000, -15.7891, -15.9219, -16.3438,
         -15.8203, -16.0781, -15.7656, -16.3438, -16.8438, -16.7344, -16.4531,
         -16.1719, -16.9531, -16.6875, -17.0312, -17.2188, -16.7969, -17.2031,
         -17.0000, -17.2344, -17.5000, -16.8438, -16.8125, -16.8125, -17.0625,
         -15.7344, -15.0469, -15.6797, -15.8672, -16.4219, -15.7500, -15.5469,
         -15.6406, -16.2031, -16.5781, -15.4297, -16.3281, -16.9375, -17.4844,
         -17.8438, -17.4844, -17.5156, -16.8594, -16.9375, -16.7656, -16.7188,
         -16.9219, -16.5938, -17.2031, -16.8750, -16.3438, -16.0000, -16.2188,
         -17.0156, -16.1875, -15.7734, -15.4844, -15.7344, -15.8906, -15.1641,
         -15.3438, -14.9375, -14.3828, -13.1562, -12.1484, -13.3750, -13.5391,
         -14.7656, -15.2422, -14.8984, -14.8672, -15.0234, -15.7344, -16.3281,
         -16.8125, -16.1719, -15.9766, -16.8438, -17.0938, -17.3750, -16.9375,
         -16.5938, -17.4219, -17.5156, -17.0938, -15.6016, -16.0781, -17.0938,
         -16.7812, -16.6406, -15.4141, -16.1094, -16.6250, -16.6406, -16.7969,
         -16.8438, -17.3594, -17.0625, -17.0938, -16.8594, -16.1875, -16.6250,
         -17.0156, -17.5625, -17.3438, -17.0312, -16.8906, -16.5312, -17.3281,
         -17.0469]], dtype=torch.float16)

# ==============================================================================
# pytorch model outputs

input_frame[0,:,:]
tensor([[-0.4783,  0.7168, -1.9131,  1.0752, -1.1953,  1.0752,  0.0000, -0.4783,
          1.7920, -0.4783,  0.7168, -0.4783,  0.3584,  0.7168,  0.0000,  1.4336,
         -0.8369,  0.7168,  0.3584, -1.1953,  1.0752, -0.8369,  0.7168,  0.7168,
          0.3584,  0.3584, -1.5527,  0.7168, -0.8369,  1.4336,  0.7168, -0.8369,
          1.4336, -1.1953,  0.3584, -0.8369,  0.3584,  0.3584, -1.5527,  0.0000,
         -1.1953,  0.7168,  0.0000,  0.0000,  1.0752, -1.1953,  1.4336,  0.3584,
          0.0000,  1.0752, -1.1953,  1.0752, -0.8369,  0.0000, -1.1953, -1.1953,
          1.4336, -0.8369,  1.0752, -0.4783,  0.0000,  0.3584, -1.5527,  1.0752,
         -0.8369,  0.7168,  0.0000, -0.4783,  1.7920, -0.8369,  1.4336, -0.8369,
         -0.4783,  1.0752, -1.1953,  0.7168,  0.0000,  1.0752, -0.4783, -0.8369,
          0.3584, -1.1953,  1.7920,  0.0000, -1.1953,  1.4336,  0.0000,  1.0752,
         -0.4783,  1.7920,  0.0000, -0.4783,  1.4336, -1.1953,  0.7168, -0.8369,
          0.0000,  0.0000, -1.1953,  0.3584, -1.5527,  0.3584,  0.0000, -0.8369,
          0.3584, -1.1953,  0.0000, -0.8369, -0.4783,  0.3584, -0.4783,  0.7168,
         -1.5527, -0.4783, -1.9131, -1.1953,  0.7168, -0.8369,  0.7168, -1.5527,
          0.0000,  0.7168,  0.0000,  1.7920, -0.4783,  0.7168,  0.3584, -0.4783,
          1.4336, -0.8369,  1.4336,  0.3584,  1.0752,  0.0000, -0.4783,  2.2715,
          0.3584,  0.0000,  0.0000,  0.0000,  0.7168,  0.0000,  0.7168, -1.1953,
          0.7168,  1.0752, -0.8369,  2.2715, -0.4783,  0.3584, -0.4783,  0.0000,
          1.0752, -1.1953,  1.0752, -0.4783, -0.4783,  0.7168, -0.4783,  1.0752,
         -0.8369,  0.7168,  0.0000,  0.3584,  1.7920, -1.1953, -0.4783, -0.4783,
         -0.4783, -0.4783, -0.8369,  1.0752, -1.9131, -0.8369, -0.8369, -0.4783,
          0.7168, -0.4783,  0.3584, -1.1953, -0.4783,  0.3584, -1.1953,  1.0752,
         -0.4783,  0.7168, -1.1953, -0.8369,  0.7168, -1.1953,  1.0752,  0.3584,
          0.0000,  0.0000, -0.4783,  0.3584, -1.1953,  0.7168, -0.4783, -1.1953]],
       dtype=torch.float16)
       
pytorch_outputs[0,:]
tensor([-15.8359, -16.4375, -16.3750, -17.2031, -16.9375, -16.6406, -16.1406,
        -16.1406, -16.7344, -16.4219, -16.5000, -15.7891, -15.9219, -16.3438,
        -15.8203, -16.0781, -15.7656, -16.3438, -16.8438, -16.7344, -16.4531,
        -16.1719, -16.9531, -16.6875, -17.0312, -17.2188, -16.7969, -17.2031,
        -17.0000, -17.2344, -17.5000, -16.8438, -16.8125, -16.8125, -17.0625,
        -15.7344, -15.0469, -15.6797, -15.8672, -16.4219, -15.7500, -15.5469,
        -15.6406, -16.2031, -16.5781, -15.4297, -16.3281, -16.9375, -17.4844,
        -17.8438, -17.4844, -17.5156, -16.8594, -16.9375, -16.7656, -16.7188,
        -16.9219, -16.5938, -17.2031, -16.8750, -16.3438, -16.0000, -16.2188,
        -17.0156, -16.1875, -15.7734, -15.4844, -15.7344, -15.8906, -15.1641,
        -15.3438, -14.9375, -14.3828, -13.1562, -12.1484, -13.3750, -13.5391,
        -14.7656, -15.2422, -14.8984, -14.8672, -15.0234, -15.7344, -16.3281,
        -16.8125, -16.1719, -15.9766, -16.8438, -17.0938, -17.3750, -16.9375,
        -16.5938, -17.4219, -17.5156, -17.0938, -15.6016, -16.0781, -17.0938,
        -16.7812, -16.6406, -15.4141, -16.1094, -16.6250, -16.6406, -16.7969,
        -16.8438, -17.3594, -17.0625, -17.0938, -16.8594, -16.1875, -16.6250,
        -17.0156, -17.5625, -17.3438, -17.0312, -16.8906, -16.5312, -17.3281,
        -17.0469], dtype=torch.float16)